<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>{{ config.title }}</title>
    <link>{{ url | uriencode }}</link>
    <atom:link href="{{ feed_url | uriencode }}" rel="self" type="application/rss+xml"/>
    {% if config.feed.hub %}<atom:link href="{{ config.feed.hub | uriencode }}" rel="hub"/>{% endif %}
    <description>{{ config.description }}</description>
    <pubDate>{{ posts.first().updated.toDate().toUTCString() }}</pubDate>
    <generator>http://hexo.io/</generator>
    {% for post in posts.toArray() %}
    <item>
      <title>{{ post.title }}</title>
      <link>{{ (url + post.path) | uriencode }}</link>
      <guid>{{ (url + post.path) | uriencode }}</guid>
      <pubDate>{{ post.date.toDate().toUTCString() }}</pubDate>
      <description>
      {% if post.description %}
        {{ post.description }}
      {% elif post.excerpt %}
        {{ post.excerpt }}
      {% elif post.content %}
       {% if not config.feed.content and config.feed.content_limit %}
         {{ post.feedShortContent }}
       {% else %}
         {{ post.content }}
       {% endif %}
      {% endif %}
      </description>
      {% if config.feed.content and post.content %}
      <content:encoded><![CDATA[{{ post.content | safe }}]]></content:encoded>
      {% endif %}
      {% if post.comments %}<comments>{{ (url + post.path) | uriencode }}#disqus_thread</comments>{% endif %}
      
      {% if post.featured_image %}
      <media:content medium="image" url="{{ (url + post.featured_image) | uriencode }}" />
      {% endif %}
      {% if post.thumbnail %}
      <media:thumbnail url="{{ (url + post.thumbnail) | uriencode }}" width="48" height="48" />
      {% endif %}
    </item>
    {% endfor %}
  </channel>
</rss>
